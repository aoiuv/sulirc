## 前言

> 正则表达式是用于匹配字符串中字符组合的模式

正则，毋庸置疑，是一个无比强大的工具。如果仔细留意，我们可以在源代码（各种语言）、编辑器、开发者工具、命令行等地方看到正则的身影。学习使用正则，不仅有趣，也是提升工作效率的一条捷径。

所以，让我们深入学习正则吧~

备注：文章将用大量图例来演示正则，而文章末尾会介绍正则的实践与应用。

## 创建正则

比如说我们想匹配以下字符串中的单词 Hello world

```js
const string = `Hello world_2019/09/19 22:50:53`;
```

我们有以下两种方式创建正则，如下。

### 字面量

一般常使用正则表达式字面量方式定义正则，适用于当正则表达式保持不变的场景。

```js
const regex = /([a-z]+)\s([a-z]+)/i;
```

如图所示：

![](https://user-gold-cdn.xitu.io/2019/9/19/16d4a1905fb769fe?w=914&h=380&f=png&s=33954)

### 构造函数

构造函数方式定义正则，提供运行时编译，适用于正则表达式来源不确定，或者动态变化组成的情况，但性能表现差于字面量定义方式。

比如上述例子可以改写为以下构造函数方式，但需要留意的是，转义字符需要多加一个斜杠进行反转义。

```js
const regex = new RegExp('([a-z]+\\s?)'.repeat(2), 'i');
```

在控制台可以看出：

![](https://user-gold-cdn.xitu.io/2019/9/19/16d4a1b343c1d8db?w=1022&h=142&f=png&s=26097)

## 基础概念

正则的常用概念可以参考下表，主要熟记字符类型、锚点、转义字符、量词等。

![](https://user-gold-cdn.xitu.io/2019/9/19/16d4a189b0cfba5b?w=734&h=1378&f=png&s=216973)

基础用法相信大家都很快理解，以下重点介绍贪婪、分组、断言、查找等。

## 贪婪与非贪婪

? 如果紧跟在任何量词 \*、 +、? 或 {} 的后面，将会使量词变为非贪婪（匹配尽量少的字符）。

而我们默认的是贪婪模式，即匹配尽可能多的字符。如下图：

![](https://user-gold-cdn.xitu.io/2019/9/19/16d4a2d69d5b5335?w=738&h=408&f=png&s=33181)

可以看到，我们匹配了尽可能多的除换行符之外的任意字符。

而加个?后，改写成非贪婪模式：

![](https://user-gold-cdn.xitu.io/2019/9/19/16d4a2f576720d14?w=810&h=424&f=png&s=34664)

则发现，只匹配了一个字符后，即停止。

## 分组与捕获

## 断言与查找

### 先行断言

模式：x(?=y)

![](https://user-gold-cdn.xitu.io/2019/9/20/16d4d12f189a9bea?w=684&h=372&f=png&s=21771)

### 正向否定查找

模式：x(?!y)

![](https://user-gold-cdn.xitu.io/2019/9/20/16d4d13a99b86879?w=642&h=382&f=png&s=22109)

### 后行断言

模式：(?<=y)x

![](https://user-gold-cdn.xitu.io/2019/9/20/16d4d14cb1e5704c?w=900&h=376&f=png&s=24985)

### 反向否定查找

模式：(?<!y)x

![](https://user-gold-cdn.xitu.io/2019/9/20/16d4d1566a2e6d50?w=878&h=382&f=png&s=25167)

### \1

\1 其实就是上一个匹配到分组引用。

比如我要在 I like JJLin and Huahua~ 中匹配 Huahua，如图：

![](https://user-gold-cdn.xitu.io/2019/9/20/16d4d18942a7e69a?w=740&h=366&f=png&s=22599)

当然以下方式也可达成：

1. 使用量词 + 或 \*
   ![](https://user-gold-cdn.xitu.io/2019/9/20/16d4d1a6ef109d30?w=758&h=370&f=png&s=22379)

2. 或者用全局搜索标志 g
   ![](https://user-gold-cdn.xitu.io/2019/9/20/16d4d1b768a7ccbf?w=650&h=372&f=png&s=20743)

3. 使用范围 {2}

![](https://user-gold-cdn.xitu.io/2019/9/20/16d4d1d1e30c04b8?w=794&h=370&f=png&s=24323)

不过，虽然条条大路通罗马，但还是需要注意匹配的 hua 数量。比如方法 1、2 都会尽可能多的匹配。

## 使用正则

### JavaScript

#### RegExp 对象

##### exec

一个在字符串中执行查找匹配的 RegExp 方法，它返回一个数组（未匹配到则返回 null）。

##### test

一个在字符串中测试是否匹配的 RegExp 方法，它返回 true 或 false。

#### String 对象

##### match

一个在字符串中执行查找匹配的 String 方法，它返回一个数组，在未匹配到时会返回 null。

##### matchAll

一个在字符串中执行查找所有匹配的 String 方法，它返回一个迭代器（iterator）。

##### search

一个在字符串中测试匹配的 String 方法，它返回匹配到的位置索引，或者在失败时返回-1。

##### replace

一个在字符串中执行查找匹配的 String 方法，并且使用替换字符串替换掉匹配到的子字符串。

##### split

一个使用正则表达式或者一个固定字符串分隔一个字符串，并将分隔后的子字符串存储到数组中的 String 方法。

### 编辑器

#### 查找

#### 替换

### 浏览器

console filter

### 命令行

grep / egrep

## 小结

到此为止，也只是比较肤浅的介绍了一下正则。正则是实践性极强的一门工具，或者说是艺术也不为过。多上手练习和使用，相信还是能起很大作用的。

以上，如果助益，不胜荣幸。
